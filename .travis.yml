language: cpp
addons:
  apt:
    packages:
    - cmake
    sources:
    - kalakris-cmake
matrix:
  include:
  - os: osx
    compiler: clang
    env: ITK_VERSION=v4.10.0
  - os: linux
    compiler: gcc
    env: ITK_VERSION=v4.10.0
cache:
- directories:
  - $HOME/itk-v4.10.0-build
  - $HOME/itk-v4.10.0
before_script:
- export NUM_THREADS=4
- export ITK_SOURCE_DIR=$HOME/itk-${ITK_VERSION}
- export ITK_BUILD_DIR=${ITK_SOURCE_DIR}-build
- if ! test -e ${ITK_SOURCE_DIR}/CMakeLists.txt; then rm -fr $ITK_SOURCE_DIR; fi
- if ! test -d ${ITK_SOURCE_DIR}; then git clone --branch ${ITK_VERSION} git://itk.org/ITK.git
  ${ITK_SOURCE_DIR}; fi
- if ! test -d ${ITK_BUILD_DIR}; then mkdir ${ITK_BUILD_DIR}; fi
- cd ${ITK_BUILD_DIR}
- cmake ${ITK_SOURCE_DIR} -DCMAKE_BUILD_TYPE=Release -DBUILD_EXAMPLES=OFF -DBUILD_TESTING=OFF
  -DModule_ITKReview=ON
- make --jobs=$NUM_THREADS --keep-going
- cd -
- cd ..
- mkdir build
- cd build
- cmake ../PETPVC
script: cmake --build . && ctest && cpack
deploy:
- provider: releases
  api_key:
    secure: bq1Uqgb3r+qecRbQIkBn0ELG4QV/SjO6VSNJHKYT6fETqVH/WTKyaErFfiipKvx/P447YQpQ2pcylotJlAuyOgePOsBIk5DZW1YpR54VYvHMgH3nI50vzb/RMvsHsQYez14Lot4S2b567Xm1OLPpLaUbmelGG+h8twzzhoPzLx4acwEitsMGlf34n1thuKO0tv5rH5Roiwk8UbstvK15XBjy43qWfkMd/mMT4oQtA4pXaK5zycsCfItIV2cnrEGFdVFQXbECuzTzey/VQzvWiFFeGks/rE6qZZhuL9FEDooZMWqvp4r62s6XBXwjVQrqwHOkkrmKzlbRhG/YkUMgBcJr9TxgOkIIIco4oy5wLTpCAT61KOzF+ebtyNuyXf7+3CbVwi71wQwNWhaO1ZIRIkWF3NreHZEjxX3C/Y05nxVgMnxC3/k5k6F4hjHBVaOnj9nnVICFHcmM+PJil3XdvMXGT7G7RTfpToPYBxxwt1TQDPLEh8YuV26Tbyr5k261eQIjvCRLmWB9ikdZ7FGCe3hG1OD2EOQUXAoq0KyERLcKU2xh/A1KbXeNx6DUa+pi14fEqTMYEpM0TxDmm3/4yX8MlNgfW+mJ8SJWaSqiM1mjt3C79sw96w1zOcmduN7zx1wYzH2qda8BrANSvKE4NLfAdPdJq+M0Te/ylsVfGn0=
  file: '*.tar.gz'
  file_glob: true
  draft: true
  skip_cleanup: true
  on:
    tags: true
    all_branches: true
